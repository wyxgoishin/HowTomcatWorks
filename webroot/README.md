This part is borrowed from [Official Source Code](https://brainysoftware.com/source/9780975212806.zip).